{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.useCartStore=void 0;var _toConsumableArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));var _zustand=require(\"zustand\");var _middleware=require(\"zustand/middleware\");var _storage=require(\"./storage\");var useCartStore=exports.useCartStore=(0,_zustand.create)()((0,_middleware.persist)(function(set,get){return{cart:[],addItem:function addItem(item){var currentCart=get().cart;var existingItemIndex=currentCart.findIndex(function(cartItem){return(cartItem==null?void 0:cartItem._id)===(item==null?void 0:item._id);});if(existingItemIndex>=0){var updatedCart=(0,_toConsumableArray2.default)(currentCart);updatedCart[existingItemIndex]=Object.assign({},updatedCart[existingItemIndex],{count:updatedCart[existingItemIndex].count+1});set({cart:updatedCart});}else{set({cart:[].concat((0,_toConsumableArray2.default)(currentCart),[{_id:item._id,item:item,count:1}])});}},clearCart:function clearCart(){return set({cart:[]});},removeItem:function removeItem(id){var currentCart=get().cart;var existingItemIndex=currentCart.findIndex(function(cartItem){return(cartItem==null?void 0:cartItem._id)===id;});if(existingItemIndex>=0){var updatedCart=(0,_toConsumableArray2.default)(currentCart);var existingItem=updatedCart[existingItemIndex];if(existingItem.count>1){updatedCart[existingItemIndex]=Object.assign({},existingItem,{count:(existingItem==null?void 0:existingItem.count)-1});}else{updatedCart.splice(existingItemIndex,1);}set({cart:updatedCart});}},getItemCount:function getItemCount(id){var currentItem=get().cart.find(function(cartItem){return cartItem._id===id;});return currentItem?currentItem==null?void 0:currentItem.count:0;},getTotalPrice:function getTotalPrice(){return get().cart.reduce(function(total,cartItem){var price=cartItem.item.discountprice>0?cartItem.item.discountprice:parseFloat(cartItem.item.price);return total+price*cartItem.count;},0);}};},{name:'cart-storage',storage:(0,_middleware.createJSONStorage)(function(){return _storage.mmkvStorage;})}));","map":{"version":3,"names":["_zustand","require","_middleware","_storage","useCartStore","exports","create","persist","set","get","cart","addItem","item","currentCart","existingItemIndex","findIndex","cartItem","_id","updatedCart","_toConsumableArray2","default","Object","assign","count","concat","clearCart","removeItem","id","existingItem","splice","getItemCount","currentItem","find","getTotalPrice","reduce","total","price","discountprice","parseFloat","name","storage","createJSONStorage","mmkvStorage"],"sources":["C:/Users/acer/Desktop/paltanweb/src/state/cartStore.tsx"],"sourcesContent":["\r\nimport { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\nimport { mmkvStorage } from './storage';\r\n\r\ninterface CartItem{\r\n    _id: string | number;\r\n    item: any;\r\n    count: number\r\n}\r\n\r\ninterface CartStore{\r\n    cart: CartItem[];\r\n    addItem: (item: any) => void;\r\n    removeItem: (id: string | number) => void;\r\n    clearCart: () => void;\r\n    getItemCount: (id: string| number)=> number;\r\n    getTotalPrice: ()=>number;\r\n\r\n}\r\n\r\n\r\nexport const useCartStore = create<CartStore>()(\r\n    persist(\r\n        (set, get) => ({\r\ncart:[],\r\naddItem:(item)=>{\r\n    const currentCart = get().cart;\r\n    const existingItemIndex = currentCart.findIndex(cartItem=>cartItem?._id === item?._id);\r\n\r\n    if(existingItemIndex >= 0){\r\n        const updatedCart = [...currentCart];\r\n        updatedCart[existingItemIndex] = {\r\n            ...updatedCart[existingItemIndex],\r\n            count: updatedCart[existingItemIndex].count + 1,\r\n        };\r\n        set({cart: updatedCart});\r\n    }else {\r\n        set({\r\n            cart:[...currentCart, {_id: item._id, item: item,count:1}],\r\n        });\r\n    }\r\n},\r\n\r\n\r\nclearCart: ()=>set({cart:[]}),\r\nremoveItem:(id)=>{\r\n    const currentCart = get().cart;\r\n    const existingItemIndex = currentCart.findIndex(cartItem=>cartItem?._id === id);\r\n    if(existingItemIndex >= 0){\r\n        const updatedCart = [...currentCart];\r\n        const existingItem = updatedCart[existingItemIndex];\r\n        if(existingItem.count > 1){\r\n                updatedCart[existingItemIndex] = {\r\n...existingItem,\r\ncount:existingItem?.count - 1,\r\n                };\r\n        }else{\r\n               updatedCart.splice(existingItemIndex,1);\r\n        }\r\n        set({cart: updatedCart});\r\n    }\r\n},\r\ngetItemCount:(id)=>{\r\n    const currentItem = get().cart.find(cartItem=>cartItem._id === id);\r\n    return currentItem ? currentItem?.count : 0;\r\n},\r\n\r\ngetTotalPrice:()=>{\r\n   return get().cart.reduce((total, cartItem) => {\r\n  const price =\r\n    cartItem.item.discountprice > 0\r\n      ? cartItem.item.discountprice\r\n      : parseFloat(cartItem.item.price);\r\n  return total + price * cartItem.count;\r\n}, 0);\r\n\r\n},\r\n\r\n        }),\r\n\r\n        {\r\n            name: 'cart-storage',\r\n            storage: createJSONStorage(()=> mmkvStorage),\r\n        }\r\n    ),\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}