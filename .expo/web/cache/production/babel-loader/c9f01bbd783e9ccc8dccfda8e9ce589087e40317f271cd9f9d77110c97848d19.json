{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.useDashboardStore=void 0;var _asyncToGenerator2=_interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));var _zustand=require(\"zustand\");var _productService=require(\"../service/productService\");var useDashboardStore=exports.useDashboardStore=(0,_zustand.create)(function(set,get){return{sections:[],products:[],sectionsLoading:true,productsLoading:true,initialized:false,fetchDashboard:function(){var _fetchDashboard=(0,_asyncToGenerator2.default)(function*(){if(get().initialized){return;}try{set({sectionsLoading:true,productsLoading:true});var mainCats=yield(0,_productService.getMainCategories)();var sectionData=yield Promise.all(mainCats.map(function(){var _ref=(0,_asyncToGenerator2.default)(function*(cat){var categories=yield(0,_productService.getAllCategoriesByMainCategoryId)(cat.id);return{mainCategory:cat,categories:categories};});return function(_x){return _ref.apply(this,arguments);};}()));var productData=yield(0,_productService.getAllProducts)(1,20);var enriched=productData.map(function(item){var _item$categoryId,_item$categoryId2;return Object.assign({},item,{categoryId:(item==null?void 0:(_item$categoryId=item.categoryId)==null?void 0:_item$categoryId._id)||'',navigateTo:(item==null?void 0:(_item$categoryId2=item.categoryId)==null?void 0:_item$categoryId2.navigateTo)||''});});set({sections:sectionData,products:enriched,sectionsLoading:false,productsLoading:false,initialized:true});}catch(err){console.error('❌ Dashboard fetch error:',err);set({sections:[],products:[],sectionsLoading:false,productsLoading:false});}});function fetchDashboard(){return _fetchDashboard.apply(this,arguments);}return fetchDashboard;}(),reloadDashboard:function(){var _reloadDashboard=(0,_asyncToGenerator2.default)(function*(){try{set({sectionsLoading:true,productsLoading:true});var mainCats=yield(0,_productService.getMainCategories)();var sectionData=yield Promise.all(mainCats.map(function(){var _ref2=(0,_asyncToGenerator2.default)(function*(cat){var categories=yield(0,_productService.getAllCategoriesByMainCategoryId)(cat.id);return{mainCategory:cat,categories:categories};});return function(_x2){return _ref2.apply(this,arguments);};}()));var productData=yield(0,_productService.getAllProducts)(1,20);var enriched=productData.map(function(item){var _item$categoryId3,_item$categoryId4;return Object.assign({},item,{categoryId:(item==null?void 0:(_item$categoryId3=item.categoryId)==null?void 0:_item$categoryId3._id)||'',navigateTo:(item==null?void 0:(_item$categoryId4=item.categoryId)==null?void 0:_item$categoryId4.navigateTo)||''});});set({sections:sectionData,products:enriched,sectionsLoading:false,productsLoading:false,initialized:true});}catch(err){console.error('❌ Dashboard reload error:',err);set({sections:[],products:[],sectionsLoading:false,productsLoading:false});}});function reloadDashboard(){return _reloadDashboard.apply(this,arguments);}return reloadDashboard;}()};});","map":{"version":3,"names":["_zustand","require","_productService","useDashboardStore","exports","create","set","get","sections","products","sectionsLoading","productsLoading","initialized","fetchDashboard","_fetchDashboard","_asyncToGenerator2","default","mainCats","getMainCategories","sectionData","Promise","all","map","_ref","cat","categories","getAllCategoriesByMainCategoryId","id","mainCategory","_x","apply","arguments","productData","getAllProducts","enriched","item","_item$categoryId","_item$categoryId2","Object","assign","categoryId","_id","navigateTo","err","console","error","reloadDashboard","_reloadDashboard","_ref2","_x2","_item$categoryId3","_item$categoryId4"],"sources":["C:/Users/acer/Desktop/paltanweb/src/state/dashboardStore.tsx"],"sourcesContent":["\r\nimport { create } from 'zustand';\r\nimport {\r\n  getMainCategories,\r\n  getAllCategoriesByMainCategoryId,\r\n  getAllProducts,\r\n} from '@service/productService';\r\n\r\ninterface MainCategory {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\ninterface CategoryById {\r\n  _id: string;\r\n  name: string;\r\n  image: string;\r\n  navigateTo: string;\r\n}\r\n\r\ninterface Section {\r\n  mainCategory: MainCategory;\r\n  categories: CategoryById[];\r\n}\r\n\r\ninterface DashboardState {\r\n  sections: Section[];\r\n  products: any[];\r\n  sectionsLoading: boolean;\r\n  productsLoading: boolean;\r\n  initialized: boolean;\r\n  fetchDashboard: () => Promise<void>;\r\n  reloadDashboard: () => Promise<void>;\r\n}\r\n\r\nexport const useDashboardStore = create<DashboardState>((set, get) => ({\r\n  sections: [],\r\n  products: [],\r\n  sectionsLoading: true,\r\n  productsLoading: true,\r\n  initialized: false,\r\n\r\n  fetchDashboard: async () => {\r\n    if (get().initialized) {return;}\r\n    try {\r\n      set({ sectionsLoading: true, productsLoading: true });\r\n      const mainCats: MainCategory[] = await getMainCategories();\r\n      const sectionData = await Promise.all(\r\n        mainCats.map(async cat => {\r\n          const categories = await getAllCategoriesByMainCategoryId(cat.id);\r\n          return { mainCategory: cat, categories };\r\n        })\r\n      );\r\n      const productData = await getAllProducts(1, 20);\r\n      const enriched = productData.map(item => ({\r\n        ...item,\r\n        categoryId: item?.categoryId?._id || '',\r\n        navigateTo: item?.categoryId?.navigateTo || '',\r\n      }));\r\n      set({\r\n        sections: sectionData,\r\n        products: enriched,\r\n        sectionsLoading: false,\r\n        productsLoading: false,\r\n        initialized: true,\r\n      });\r\n    } catch (err) {\r\n      console.error('❌ Dashboard fetch error:', err);\r\n      set({ sections: [], products: [], sectionsLoading: false, productsLoading: false });\r\n    }\r\n  },\r\n\r\n  reloadDashboard: async () => {\r\n    try {\r\n      set({ sectionsLoading: true, productsLoading: true });\r\n      const mainCats: MainCategory[] = await getMainCategories();\r\n      const sectionData = await Promise.all(\r\n        mainCats.map(async cat => {\r\n          const categories = await getAllCategoriesByMainCategoryId(cat.id);\r\n          return { mainCategory: cat, categories };\r\n        })\r\n      );\r\n      const productData = await getAllProducts(1, 20);\r\n      const enriched = productData.map(item => ({\r\n        ...item,\r\n        categoryId: item?.categoryId?._id || '',\r\n        navigateTo: item?.categoryId?.navigateTo || '',\r\n      }));\r\n      set({\r\n        sections: sectionData,\r\n        products: enriched,\r\n        sectionsLoading: false,\r\n        productsLoading: false,\r\n        initialized: true,\r\n      });\r\n    } catch (err) {\r\n      console.error('❌ Dashboard reload error:', err);\r\n      set({ sections: [], products: [], sectionsLoading: false, productsLoading: false });\r\n    }\r\n  },\r\n}));\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}