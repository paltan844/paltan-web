{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useCartStore = void 0;\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\nvar _zustand = require(\"zustand\");\nvar _middleware = require(\"zustand/middleware\");\nvar _storage = require(\"./storage\");\nvar useCartStore = exports.useCartStore = (0, _zustand.create)()((0, _middleware.persist)(function (set, get) {\n  return {\n    cart: [],\n    addItem: function addItem(item) {\n      var currentCart = get().cart;\n      var existingItemIndex = currentCart.findIndex(function (cartItem) {\n        return (cartItem == null ? void 0 : cartItem._id) === (item == null ? void 0 : item._id);\n      });\n      if (existingItemIndex >= 0) {\n        var updatedCart = (0, _toConsumableArray2.default)(currentCart);\n        updatedCart[existingItemIndex] = Object.assign({}, updatedCart[existingItemIndex], {\n          count: updatedCart[existingItemIndex].count + 1\n        });\n        set({\n          cart: updatedCart\n        });\n      } else {\n        set({\n          cart: [].concat((0, _toConsumableArray2.default)(currentCart), [{\n            _id: item._id,\n            item: item,\n            count: 1\n          }])\n        });\n      }\n    },\n    clearCart: function clearCart() {\n      return set({\n        cart: []\n      });\n    },\n    removeItem: function removeItem(id) {\n      var currentCart = get().cart;\n      var existingItemIndex = currentCart.findIndex(function (cartItem) {\n        return (cartItem == null ? void 0 : cartItem._id) === id;\n      });\n      if (existingItemIndex >= 0) {\n        var updatedCart = (0, _toConsumableArray2.default)(currentCart);\n        var existingItem = updatedCart[existingItemIndex];\n        if (existingItem.count > 1) {\n          updatedCart[existingItemIndex] = Object.assign({}, existingItem, {\n            count: (existingItem == null ? void 0 : existingItem.count) - 1\n          });\n        } else {\n          updatedCart.splice(existingItemIndex, 1);\n        }\n        set({\n          cart: updatedCart\n        });\n      }\n    },\n    getItemCount: function getItemCount(id) {\n      var currentItem = get().cart.find(function (cartItem) {\n        return cartItem._id === id;\n      });\n      return currentItem ? currentItem == null ? void 0 : currentItem.count : 0;\n    },\n    getTotalPrice: function getTotalPrice() {\n      return get().cart.reduce(function (total, cartItem) {\n        var price = cartItem.item.discountprice > 0 ? cartItem.item.discountprice : parseFloat(cartItem.item.price);\n        return total + price * cartItem.count;\n      }, 0);\n    }\n  };\n}, {\n  name: 'cart-storage',\n  storage: (0, _middleware.createJSONStorage)(function () {\n    return _storage.mmkvStorage;\n  })\n}));","map":{"version":3,"names":["_zustand","require","_middleware","_storage","useCartStore","exports","create","persist","set","get","cart","addItem","item","currentCart","existingItemIndex","findIndex","cartItem","_id","updatedCart","_toConsumableArray2","default","Object","assign","count","concat","clearCart","removeItem","id","existingItem","splice","getItemCount","currentItem","find","getTotalPrice","reduce","total","price","discountprice","parseFloat","name","storage","createJSONStorage","mmkvStorage"],"sources":["C:/Users/acer/Desktop/paltanweb/src/state/cartStore.tsx"],"sourcesContent":["\r\nimport { create } from 'zustand';\r\nimport { persist, createJSONStorage } from 'zustand/middleware';\r\nimport { mmkvStorage } from './storage';\r\n\r\ninterface CartItem{\r\n    _id: string | number;\r\n    item: any;\r\n    count: number\r\n}\r\n\r\ninterface CartStore{\r\n    cart: CartItem[];\r\n    addItem: (item: any) => void;\r\n    removeItem: (id: string | number) => void;\r\n    clearCart: () => void;\r\n    getItemCount: (id: string| number)=> number;\r\n    getTotalPrice: ()=>number;\r\n\r\n}\r\n\r\n\r\nexport const useCartStore = create<CartStore>()(\r\n    persist(\r\n        (set, get) => ({\r\ncart:[],\r\naddItem:(item)=>{\r\n    const currentCart = get().cart;\r\n    const existingItemIndex = currentCart.findIndex(cartItem=>cartItem?._id === item?._id);\r\n\r\n    if(existingItemIndex >= 0){\r\n        const updatedCart = [...currentCart];\r\n        updatedCart[existingItemIndex] = {\r\n            ...updatedCart[existingItemIndex],\r\n            count: updatedCart[existingItemIndex].count + 1,\r\n        };\r\n        set({cart: updatedCart});\r\n    }else {\r\n        set({\r\n            cart:[...currentCart, {_id: item._id, item: item,count:1}],\r\n        });\r\n    }\r\n},\r\n\r\n\r\nclearCart: ()=>set({cart:[]}),\r\nremoveItem:(id)=>{\r\n    const currentCart = get().cart;\r\n    const existingItemIndex = currentCart.findIndex(cartItem=>cartItem?._id === id);\r\n    if(existingItemIndex >= 0){\r\n        const updatedCart = [...currentCart];\r\n        const existingItem = updatedCart[existingItemIndex];\r\n        if(existingItem.count > 1){\r\n                updatedCart[existingItemIndex] = {\r\n...existingItem,\r\ncount:existingItem?.count - 1,\r\n                };\r\n        }else{\r\n               updatedCart.splice(existingItemIndex,1);\r\n        }\r\n        set({cart: updatedCart});\r\n    }\r\n},\r\ngetItemCount:(id)=>{\r\n    const currentItem = get().cart.find(cartItem=>cartItem._id === id);\r\n    return currentItem ? currentItem?.count : 0;\r\n},\r\n\r\ngetTotalPrice:()=>{\r\n   return get().cart.reduce((total, cartItem) => {\r\n  const price =\r\n    cartItem.item.discountprice > 0\r\n      ? cartItem.item.discountprice\r\n      : parseFloat(cartItem.item.price);\r\n  return total + price * cartItem.count;\r\n}, 0);\r\n\r\n},\r\n\r\n        }),\r\n\r\n        {\r\n            name: 'cart-storage',\r\n            storage: createJSONStorage(()=> mmkvStorage),\r\n        }\r\n    ),\r\n);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}